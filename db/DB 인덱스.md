# DB 인덱스

# DB 의 인덱스란??

- 테이블의 검색 속도를 향상시키기 위한 것이라고 보면 된다.
- 책의 마지막에 있는 '색인' 페이지와 비슷하다고 생각하면 이해하기 편하다.
- 테이블 전체를 조회하기에는 시간이 걸리니 성능 향상을 위해 칼럼의 값과 해당 레코드가 저장된 주소를 키와 값의 형태로 인덱스를 만들어 둔다.
- SELCT 의 WHERE 절에 사용되는것이고, WHERE 절을 쓰지 않으면 Index 는 의미가 없다.

### 장점

- 테이블에서 검색과 정렬 속도를 향상시킨다.
- 큰 테이블을 전체를 읽는게 아니기때문에 시스템 부하도 적게 소모한다.

### 단점

- 인덱스를 관리하기 위해 추가적인 저장공간이 필요하다.
- 잘 사용하지 않는 다면 오히려 속도가 느려지는 현상이 있을 수 있다.
- 자주 수정, 삭제가 이루어지는 table 에서 Index 를 자주 갱신해야 된다.

# Index 사용 예시

### 인덱스 생성 예시

```sql
-- ex)
CREATE INDEX EX_INDEX_USER ON USERS(NAME,ADDRESS);
```

### 인덱스 조회 예시

```sql
-- ex)
SELECT * FROM EX_INDEX_USER WHERE TABLE_NAME = 'USERS';
```

### 인덱스 삭제 예시

```sql
-- ex)
DROP INDEX EX_INDEX_USER;
```

- 인덱스가 너무 많이 들어가면 INSERT, UPDATE, DELETE 에 성능이 저하되므로 안쓰는 것은 바로바로 삭제시키자.


# 어떻게 사용할 때 효과가 좋을까??

## 무조건 많이??

- No 이다. 인덱스도 DB 의 메모리를 사용하는 거기때문에 Index 갯수가 많을수록 저장공간을 많이 차지 한다고 보면 된다.

## 그럼 어떻게 효율적으로 사용할까?

- Index 는 테이블당 3~5개 정도까지만 되도록 설정하는게 좋다고 합니다.
- 보통 4가지 기준을 지표로 판단하면 좋다고 합니다.
    - 카디널리티 - Cardinality
    - 선택토 - Selectivity
    - 활용도
    - 중복도

### 카디널리티(Cardinality)

- 카디널리티가 높을수록 인덱스 설정에 좋은 컬럼입니다.
    - 중복도가 낮으면 카디널리티가 높다 라고 표현합니다.
    - 중복도가 높으면 카디널리티가 낮다 라고 표현합니다.

ex)

학교에서 학생의 학번 과 성별 이 있다고 하자.

- 학번 은 학생 개개인 마다 있으니깐 중복도가 낮다 즉 - 카디널리티가 높다 - 라고 할 수 있다.
- 성별 은 '남', '여' 두가지밖에 없고 중복도가 높다  즉 - 카디널리티가 낮다 - 라고 할 수 있다.

### 선택도(Selectivity)

- 선택도가 낮을수록 인덱스 설정에 좋은 컬럼입니다.
    - 선택도란 전체 레코드 중에서 조건절에 의해 선택될 것으로 예상되는 레코드의 비율(%) 이다.

  > = 컬럽의 특정 값의 ROW 수 / 테이블의 총 ROW 수 * 100
  > = 컬럼의 값들의 평균 ROW 수 / 테이블의 총 ROW 수 * 100

  조금 간단하게 where 했을때 선택되는 값들의 갯수를
  전체 갯수로 나눈것들의 비율이라고 보면 된다.

ex)

같이 학교에서 학생의 학번과 성별 이 있다고 하자. + 성별은 반반이다.

- '학번' 의 선택도 = 1/10 * 100  = 10%
    - SELECT COUNT(1) FROM '학생' WHERE '학번' = 1;
        - (모두 고유하므로 특정 값 : 1)
- '성별' 의 선택도 = 5/10 * 100 = 50%
    - SELECT COUNT(1) FROM '학생' WHERE '성별' = '남자';
        - (5명이 같으므로 특정 값 : 5)

### 활용도

- 활용도가 높을 수록 인덱스 설정에 좋은 컬럼이다.
- 말 그대로 자주 사용되는것일수록 인덱스 설정하면 효과를 더 본다.

### 중복도

- 중복도가 적을수록 인덱스 설정에 좋은 컬럼이다.
- 이건 컬럼에 대한게 아니라 인덱스에 관련된 것이다.
- 인덱스끼리 같은 컬럼을 되도록이면 적게 잡고 있는것이 좋다.
- 같은 컬럼끼리 중복으로 설정이 가능하고, 중복인덱스가 설정되더라도 내부에서 자체 연산이 빠른 순서에 의해 데이터를 조회하지만, 인덱스도 메모리를 차지하기때문에 중복되는것중 필요없는것은 정리하는것이 좋다.

---

참조

[https://yurimkoo.github.io/db/2020/03/14/db-index.htm](https://yurimkoo.github.io/db/2020/03/14/db-index.html)

[https://junhyunny.github.io/information/database-index-and-considerations/](https://junhyunny.github.io/information/database-index-and-considerations/)

[https://coding-factory.tistory.com/746](https://coding-factory.tistory.com/746)